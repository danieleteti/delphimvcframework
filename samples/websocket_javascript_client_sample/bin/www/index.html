<!DOCTYPE html>
<!--
***************************************************************************

Delphi MVC Framework

Copyright (c) 2010-2025 Daniele Teti and the DMVCFramework Team

https://github.com/danieleteti/delphimvcframework

***************************************************************************

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

***************************************************************************
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-Time System Monitor - DMVCFramework WebSocket Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #06b6d4 100%);
            color: #fff;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeIn 0.8s ease-in;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .connection-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 25px;
            margin-top: 15px;
            font-weight: bold;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ff4444;
            animation: pulse 1.5s infinite;
        }

        .status-dot.connected {
            background: #44ff44;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .card {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            animation: slideUp 0.5s ease-out;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.3);
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card h3 {
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
        }

        .metric {
            font-size: 3em;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        .metric.update {
            animation: pulse-scale 0.3s ease;
        }

        @keyframes pulse-scale {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .chart-container {
            position: relative;
            height: 150px;
            margin-top: 15px;
            background: rgba(255,255,255,0.08);
            border-radius: 8px;
        }

        #stockChart {
            width: 100%;
            height: 100%;
            border-radius: 8px;
        }

        .bar-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 100%;
            gap: 4px;
        }

        .bar {
            flex: 1;
            background: linear-gradient(to top, #4ade80, #22c55e);
            border-radius: 4px 4px 0 0;
            transition: height 0.4s ease;
            min-height: 2px;
            position: relative;
        }

        .message-log {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .message-log::-webkit-scrollbar {
            width: 8px;
        }

        .message-log::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }

        .message-log::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 5px;
            border-left: 3px solid #60a5fa;
            padding-left: 10px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .log-entry.echo {
            border-left-color: #fbbf24;
        }

        .log-entry.heartbeat {
            border-left-color: #34d399;
        }

        .timestamp {
            color: #94a3b8;
            font-size: 0.85em;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        button {
            background: rgba(255,255,255,0.25);
            border: 2px solid rgba(255,255,255,0.4);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
        }

        button:hover {
            background: rgba(255,255,255,0.35);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        button:active {
            transform: translateY(0);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            text-align: center;
        }

        .stat-item {
            flex: 1;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #fbbf24;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 5px;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            opacity: 0.8;
        }

        .highlight {
            color: #fbbf24;
            font-weight: bold;
        }

        .stock-legend {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.1);
            padding: 8px 15px;
            border-radius: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .stock-price {
            font-weight: bold;
            color: #fbbf24;
            margin-left: auto;
        }

        .stock-selector {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .stock-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .stock-item:hover {
            background: rgba(255,255,255,0.15);
            transform: translateX(5px);
        }

        .stock-item.active {
            background: rgba(59, 130, 246, 0.3);
            border-color: #3b82f6;
        }

        .stock-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stock-symbol {
            font-weight: bold;
            font-size: 1.1em;
            min-width: 60px;
        }

        .stock-name {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .stock-value {
            font-weight: bold;
            font-size: 1em;
            color: #fbbf24;
        }

        .stock-color-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 2px solid white;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìà Real-Time Stock Monitor</h1>
            <p class="subtitle">DMVCFramework WebSocket Push Demo - ITDevCon 2025</p>
            <div class="connection-status">
                <span class="status-dot" id="statusDot"></span>
                <span id="statusText">Disconnected</span>
            </div>
        </header>

        <div class="dashboard">
            <!-- Real-time Stock Chart (Takes most space) -->
            <div class="card" style="grid-column: span 2;">
                <h3>üìà Real-Time Stock Prices</h3>
                <div class="chart-container" style="height: 350px;">
                    <canvas id="stockChart"></canvas>
                </div>
                <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.2);">
                    <div style="text-align: center;">
                        <div style="font-size: 0.85em; opacity: 0.8; margin-bottom: 5px;">Push Technology</div>
                        <div style="font-weight: bold; font-size: 1.1em; color: #34d399;">‚úì Real-Time Updates</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 0.85em; opacity: 0.8; margin-bottom: 5px;">Update Interval</div>
                        <div id="updateInterval" style="font-weight: bold; font-size: 1.1em; color: #fbbf24;">‚ö° Loading...</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 0.85em; opacity: 0.8; margin-bottom: 5px;">Connection Type</div>
                        <div style="font-weight: bold; font-size: 1.1em; color: #e879f9;">üîå WebSocket</div>
                    </div>
                </div>
            </div>

            <!-- Stock Selector -->
            <div class="card">
                <h3>üìã Select Stocks</h3>
                <div class="stock-selector" id="stockSelector">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Stats Row -->
        <div class="card" style="margin-bottom: 30px;">
            <h3>üìä Statistics</h3>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="messageCount">0</div>
                    <div class="stat-label">Total Messages</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="heartbeatCount">0</div>
                    <div class="stat-label">Stock Updates</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="latency">0ms</div>
                    <div class="stat-label">Avg Latency</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="uptime">0s</div>
                    <div class="stat-label">Uptime</div>
                </div>
            </div>
        </div>

        <!-- Message Log Card -->
        <div class="card">
            <h3>üìù Live Message Log</h3>
            <div class="message-log" id="messageLog">
                <div class="log-entry">
                    <span class="timestamp">[System]</span> Waiting for connection...
                </div>
            </div>
            <div class="controls">
                <button id="sendBtn">Send Test Message</button>
                <button id="clearBtn">Clear Log</button>
                <button id="reconnectBtn">Reconnect</button>
            </div>
        </div>

        <footer>
            <p>
                üí° <span class="highlight">WebSocket Push Technology</span> enables real-time, bidirectional communication.
                <br>
                The server actively pushes data to clients without polling!
            </p>
            <p style="margin-top: 10px; font-size: 0.9em;">
                Built with <span class="highlight">DelphiMVCFramework</span> WebSocket Server
            </p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>
