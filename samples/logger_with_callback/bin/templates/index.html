<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logger With Callback Sample</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
        }
        .btn-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        button {
            padding: 15px 30px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
            transition: opacity 0.2s;
        }
        button:hover {
            opacity: 0.8;
        }
        .btn-debug {
            background: #6c757d;
        }
        .btn-info {
            background: #17a2b8;
        }
        .btn-warning {
            background: #ffc107;
            color: #333;
        }
        .btn-error {
            background: #dc3545;
        }
        .btn-fatal {
            background: #721c24;
        }
        .message {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        .message.show {
            display: block;
        }
        .message.success {
            background: #d4edda;
            color: #155724;
        }
        .note {
            margin-top: 30px;
            padding: 15px;
            background: #fff3cd;
            border-radius: 5px;
            color: #856404;
        }
    </style>
</head>
<body>
    <h1>Logger With Callback Sample</h1>
    <p>A <strong>DMVCFramework</strong> sample demonstrating LoggerPro callback appender.</p>
    <p>Click a button to send a log message of the corresponding level:</p>
    <div class="btn-container">
        <button class="btn-debug" onclick="sendLog('debug')">DEBUG</button>
        <button class="btn-info" onclick="sendLog('info')">INFO</button>
        <button class="btn-warning" onclick="sendLog('warning')">WARNING</button>
        <button class="btn-error" onclick="sendLog('error')">ERROR</button>
        <button class="btn-fatal" onclick="sendLog('fatal')">FATAL</button>
    </div>
    <div id="message" class="message"></div>
    <div class="note">
        <strong>Note:</strong> Run this program in debug mode and check the Delphi "Event" debug window to see the logs.<br>
        Log files are also generated in the custom path "MyFolder\MyLogs".<br><br>
        <strong>Callback Beep:</strong> From WARNING to FATAL, a callback will trigger a beep sound:<br>
        - <strong>WARNING</strong>: single high-pitched beep<br>
        - <strong>ERROR</strong>: double medium-pitched beep<br>
        - <strong>FATAL</strong>: triple low descending beeps (most threatening)
    </div>
    <script>
        async function sendLog(level) {
            try {
                if (window.lastTimeout) {
                    clearTimeout(window.lastTimeout);
                }
                const response = await fetch('/log/' + level, { method: 'POST' });
                const text = await response.text();
                const msgEl = document.getElementById('message');
                msgEl.textContent = text;
                msgEl.className = 'message show success';
                window.lastTimeout = setTimeout(() => msgEl.className = 'message', 5000);
            } catch (e) {
                alert('Error: ' + e.message);
            }
        }
    </script>
</body>
</html>
